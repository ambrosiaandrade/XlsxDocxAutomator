<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Upload de Planilha — Excel / Google Sheets</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <div class="card">
        <div class="tabs">
          <div class="tab active" data-tab="upload">Upload</div>
          <div class="tab" data-tab="config">Configurações</div>
        </div>

        <!-- Conteúdo da aba Upload -->
        <div id="tab-upload" class="tab-content active">
          <h1>Enviar planilha (Excel ou Google Sheets)</h1>
          <p class="muted">
            Escolha um arquivo Excel (.xls, .xlsx, .csv) ou cole o link público
            de uma Google Sheet.
          </p>

          <!-- Upload de arquivo -->
          <div>
            <label for="fileInput">Arquivo Excel (.xls, .xlsx, .csv)</label>
            <div class="row">
            <input
              id="fileInput"
              type="file"
              accept=".xls,.xlsx,.csv,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,text/csv"
            />
            <button id="uploadBtn" class="btn">Enviar arquivo</button>
            </div>
            <div class="note">Dica: arraste e solte o arquivo aqui.</div>
          </div>

          <div class="or">ou</div>

          <!-- Google Sheets -->
          <div>
            <label for="sheetUrl">Link da Google Sheet</label>
            <div class="row">
              <input
                id="sheetUrl"
                class="col"
                type="url"
                placeholder="https://docs.google.com/spreadsheets/d/ID/edit#gid=0"
              />
              <button id="importBtn" class="btn">Importar</button>
            </div>
          </div>

          <!-- Ações -->
          <div
            style="
              margin-top: 18px;
              display: flex;
              gap: 8px;
              align-items: center;
            "
          >
            <button id="clearBtn" class="btn secondary">Limpar</button>
          </div>
        </div>

        <!-- Conteúdo da aba Configurações -->
        <div id="tab-config" class="tab-content">
          <h2>Configurações</h2>

          <p class="muted">
            Digite os campos para enviar pelo e-mail do <strong>Google (Gmail)</strong> ou <strong>Outlook</strong>.
          </p>

          <div style="margin-bottom: 16px">
            <label for="fieldProvider">Provedor de email</label>
            <select id="fieldProvider" class="col">
              <option value="gmail">Gmail</option>
              <option value="outlook">Outlook</option>
            </select>
          </div>

          <div style="margin-bottom: 16px">
            <label for="fieldEmail">Email</label>
            <input type="email" id="fieldEmail" class="col" placeholder="seuemail@exemplo.com">
          </div>

          <div style="margin-bottom: 16px">
            <label for="fieldPassword">Senha / App Password</label>
            <input type="password" id="fieldPassword" class="col" placeholder="•••••••••">

            <small class="muted">
              <ul style="margin: 8px 0; padding-left: 20px;">
                <li><strong>Gmail:</strong> É obrigatório usar uma <em>Senha de App</em> (não sua senha normal).<br>
                  Gere em:
                  <a href="https://myaccount.google.com/apppasswords" target="_blank">
                    https://myaccount.google.com/apppasswords
                  </a>
                </li>
                <li><strong>Outlook:</strong> Você pode usar sua senha normal, a menos que sua conta tenha 2FA ativado.<br>
                  Nesse caso, também precisará criar uma senha de app.</li>
              </ul>
            </small>
          </div>

          <div style="display: flex; gap: 8px; margin-top: 20px">
            <button id="mailCredentialsBtn" class="btn">Salvar credenciais</button>
            <button id="testCredentialsBtn" class="btn">Testar credenciais</button>
            <button id="generateBtn" class="btn">Gerar documentos</button>
          </div>
        </div>

      </div>
    </div>

    <div class="container">
    <div class="progress" aria-hidden="true" style="margin-top: 12px">
      <i id="progressBar"></i>
    </div>
    <div id="status" class="response" style="display: none"></div>
    </div>
    <script src="/script.js"></script>
  </body>
</html>
